<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!--Description-->
    
        <meta name="description" content="">
    

    <!--Author-->
    
        <meta name="author" content="John Doe">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="USING FCN IN IMAGE SEGMENTATION FOR MNIST DATASET"/>
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="Weijia Wu"/>

    <!--Page Cover-->
    
        <meta property="og:image" content=""/>
    

    <!-- Title -->
    
    <title>USING FCN IN IMAGE SEGMENTATION FOR MNIST DATASET - Weijia Wu</title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/sass/main.css">

    <!--[if lt IE 8]>
        <script src="/js/ie/html5shiv.js"></script>
    <![endif]-->

    <!--[if lt IE 8]>
        <link rel="stylesheet" href="/sass/ie8.css">
    <![endif]-->

    <!--[if lt IE 9]>
        <link rel="stylesheet" href="/sass/ie9.css">
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Google Analytics -->
    


</head>

<body>

    <div id="wrapper">

        <!-- Menu -->
        <!-- Header -->
<header id="header">
    <div class="inner">

        <!-- Logo -->
        <a href="/" class="logo">
            <span class="symbol"><img src="/images/logo_walle.jpg" alt="" /></span><span class="title">Weijia Wu</span>
        </a>

        <!-- Nav -->
        <nav>
            <ul>
                <li><a href="#menu">Menu</a></li>
            </ul>
        </nav>

    </div>
</header>

<!-- Menu -->
<nav id="menu">
    <h2>Menu</h2>
    <ul>
        
            <li>
                <a href="/">Home</a>
            </li>
        
            <li>
                <a href="/archives">Archives</a>
            </li>
        
            <li>
                <a href="/CV/Weijia_CV.pdf">Resume</a>
            </li>
        
            <li>
                <a href="/about.html">About</a>
            </li>
        
    </ul>
</nav>


        <div id="main">
            <div class="inner">

                <!-- Main Content -->
                

    <h1>USING FCN IN IMAGE SEGMENTATION FOR MNIST DATASET</h1>



<!-- Gallery -->


<!-- Content -->
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css"><div class=".article-gallery" <h2="" id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview<p>Here I build up a FCN with skip-channel to segment the number from MNIST dataset.</p>
<h2 id="Data-download-and-synthesis"><a href="#Data-download-and-synthesis" class="headerlink" title="Data download and synthesis"></a>Data download and synthesis</h2><p>First, the dataset used is from MNIST. Here, I directly used PyTorch to download the images from “0” to “9”. To make this process more convenient, I used the “DataLoader” in PyTorch to provide randomly the image data for each time. Last but not least, merge four images together as a new image together with different color according to different number. For example, the pixels belonged to number “0” were set as “25” and the number “9” is “250”. All the data here would serve as the target images.</p>
<p><a href="/gt_image_0.png" title="alt text" class="gallery-item"><img src="/2018/04/11/USING-FCN-IN-IMAGE-SEGMENTATION-FOR-MNIST-DATASET/gt_image_0.png" alt="alt text"></a><a href="/gt_image_1.png" title="alt text" class="gallery-item"><img src="/2018/04/11/USING-FCN-IN-IMAGE-SEGMENTATION-FOR-MNIST-DATASET/gt_image_1.png" alt="alt text" title="FCN architecture"></a><a href="/gt_image_2.png" title="alt text" class="gallery-item"><img src="/2018/04/11/USING-FCN-IN-IMAGE-SEGMENTATION-FOR-MNIST-DATASET/gt_image_2.png" alt="alt text" title="FCN architecture"></a><a href="/gt_image_3.png" title="alt text" class="gallery-item"><img src="/2018/04/11/USING-FCN-IN-IMAGE-SEGMENTATION-FOR-MNIST-DATASET/gt_image_3.png" alt="alt text" title="FCN architecture"></a><a href="/gt_image_4.png" title="alt text" class="gallery-item"><img src="/2018/04/11/USING-FCN-IN-IMAGE-SEGMENTATION-FOR-MNIST-DATASET/gt_image_4.png" alt="alt text" title="FCN architecture"></a><a href="/gt_image_5.png" title="alt text" class="gallery-item"><img src="/2018/04/11/USING-FCN-IN-IMAGE-SEGMENTATION-FOR-MNIST-DATASET/gt_image_5.png" alt="alt text" title="FCN architecture"></a><a href="/gt_image_6.png" title="alt text" class="gallery-item"><img src="/2018/04/11/USING-FCN-IN-IMAGE-SEGMENTATION-FOR-MNIST-DATASET/gt_image_6.png" alt="alt text" title="FCN architecture"></a><a href="/gt_image_7.png" title="alt text" class="gallery-item"><img src="/2018/04/11/USING-FCN-IN-IMAGE-SEGMENTATION-FOR-MNIST-DATASET/gt_image_7.png" alt="alt text" title="FCN architecture"></a><a href="/gt_image_8.png" title="alt text" class="gallery-item"><img src="/2018/04/11/USING-FCN-IN-IMAGE-SEGMENTATION-FOR-MNIST-DATASET/gt_image_8.png" alt="alt text" title="FCN architecture"></a><a href="/gt_image_9.png" title="alt text" class="gallery-item"><img src="/2018/04/11/USING-FCN-IN-IMAGE-SEGMENTATION-FOR-MNIST-DATASET/gt_image_9.png" alt="alt text" title="FCN architecture"></a><a href="/gt_image_10.png" title="alt text" class="gallery-item"><img src="/2018/04/11/USING-FCN-IN-IMAGE-SEGMENTATION-FOR-MNIST-DATASET/gt_image_10.png" alt="alt text" title="FCN architecture"></a><a href="/gt_image_11.png" title="alt text" class="gallery-item"><img src="/2018/04/11/USING-FCN-IN-IMAGE-SEGMENTATION-FOR-MNIST-DATASET/gt_image_11.png" alt="alt text" title="FCN architecture"></a><a href="/gt_image_12.png" title="alt text" class="gallery-item"><img src="/2018/04/11/USING-FCN-IN-IMAGE-SEGMENTATION-FOR-MNIST-DATASET/gt_image_12.png" alt="alt text" title="FCN architecture"></a><a href="/gt_image_13.png" title="alt text" class="gallery-item"><img src="/2018/04/11/USING-FCN-IN-IMAGE-SEGMENTATION-FOR-MNIST-DATASET/gt_image_13.png" alt="alt text" title="FCN architecture"></a><a href="/gt_image_14.png" title="alt text" class="gallery-item"><img src="/2018/04/11/USING-FCN-IN-IMAGE-SEGMENTATION-FOR-MNIST-DATASET/gt_image_14.png" alt="alt text" title="FCN architecture"></a><a href="/gt_image_15.png" title="alt text" class="gallery-item"><img src="/2018/04/11/USING-FCN-IN-IMAGE-SEGMENTATION-FOR-MNIST-DATASET/gt_image_15.png" alt="alt text" title="FCN architecture"></a><a href="/gt_image_16.png" title="alt text" class="gallery-item"><img src="/2018/04/11/USING-FCN-IN-IMAGE-SEGMENTATION-FOR-MNIST-DATASET/gt_image_16.png" alt="alt text" title="FCN architecture"></a><a href="/gt_image_17.png" title="alt text" class="gallery-item"><img src="/2018/04/11/USING-FCN-IN-IMAGE-SEGMENTATION-FOR-MNIST-DATASET/gt_image_17.png" alt="alt text" title="FCN architecture"></a><a href="/gt_image_18.png" title="alt text" class="gallery-item"><img src="/2018/04/11/USING-FCN-IN-IMAGE-SEGMENTATION-FOR-MNIST-DATASET/gt_image_18.png" alt="alt text" title="FCN architecture"></a><a href="/gt_image_19.png" title="alt text" class="gallery-item"><img src="/2018/04/11/USING-FCN-IN-IMAGE-SEGMENTATION-FOR-MNIST-DATASET/gt_image_19.png" alt="alt text" title="FCN architecture"></a></p>
<h2 id="Neural-Network-Design"><a href="#Neural-Network-Design" class="headerlink" title="Neural Network Design"></a>Neural Network Design</h2><h3 id="Intuitive-idea"><a href="#Intuitive-idea" class="headerlink" title="Intuitive idea"></a>Intuitive idea</h3><p>Because here my job was to compare each pixel of input data with the pixel of target image, the input should be normal image and the output should be the target image. However, traditionally, the classical method used in image process is CNN, and it will decrease the image size. If I only continued in this direction, there would not be possible to compare the result with the target image. After studying, I found out a very interesting method used in image segmentation which was called “Fully Convolutional  Network”, in short, “FCN”.</p>
<h3 id="FCN-Introduction"><a href="#FCN-Introduction" class="headerlink" title="FCN Introduction"></a>FCN Introduction</h3><p>In my understanding, image processing means to first extract features, and then use the features to classify the image. As a result, the basic idea of FCN is to use the “encoder” and the “decoder” to first extract features from image and then reconstruct the image according to the features. Here, I still used CNN to extract the features as the encoder. As for the decoder, transposed convolutional network was used to upgrade the features to the full image.</p>
<h3 id="FCN-architecture"><a href="#FCN-architecture" class="headerlink" title="FCN architecture"></a>FCN architecture</h3><p>The structure of my neural network is as followed:</p>
<p><a href="/FCN_MNIST.png" title="alt text" class="gallery-item"><img src="/2018/04/11/USING-FCN-IN-IMAGE-SEGMENTATION-FOR-MNIST-DATASET/FCN_MNIST.png" alt="alt text" title="FCN architecture"></a></p>
<h3 id="Result-of-the-segmentation"><a href="#Result-of-the-segmentation" class="headerlink" title="Result of the segmentation"></a>Result of the segmentation</h3><p><a href="/result_0.jpg" title="alt text" class="gallery-item"><img src="/2018/04/11/USING-FCN-IN-IMAGE-SEGMENTATION-FOR-MNIST-DATASET/result_0.jpg" alt="alt text" title="FCN architecture"></a></p>
<h2 id="Thoughts"><a href="#Thoughts" class="headerlink" title="Thoughts"></a>Thoughts</h2><p>1) First, this is my first try on tuning an advanced neural network and I got a lot of experience from it. For example, I leant how to determine the size of the kernel. At first, I tried to set the kernel size as 11 or even larger. It turned out to converge very slowly because the it resulted in much more computation work to make it converged.</p>
<p>2) I leant that convolution was a local and linear operation in neural network. So for the global recognition job of image, it is better to still use fully connected layer to utilize the global information.</p>
<p>3) This works is not meaningful for push forward the development of image segmentation. But it made me understand more about neural network, and know my interested area is not in image segmentation. As the consequence, I did not go further in it and now my interest is in deep reinforcement learning.</p>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>

<!-- Tags -->



<div class="tags">
    <a href="/tags/Machine-Learning/" class="button small">Machine Learning</a>
</div>



<!-- Comments -->
<div>
    


</div>



            </div>
        </div>

        <!-- Footer -->
<footer id="footer">
    <div class="inner">
        <section>
            <h2>About</h2>
            <div>
                Thank you for visiting my homepage. For any question, please contact me in wuweijia1994atgmail.com
            </div>
        </section>
        <section>
            <h2>Follow</h2>
            <ul class="icons">
                
                    <li><a href="https://twitter.com/?lang=en" class="icon style2 fa-twitter" target="_blank" ><span class="label">Twitter</span></a></li>
                
                
                    <li><a href="https://www.facebook.com/" class="icon style2 fa-facebook" target="_blank" ><span class="label">Facebook</span></a></li>
                
                
                    <li><a href="https://www.instagram.com/" class="icon style2 fa-instagram" target="_blank" ><span class="label">Instagram</span></a></li>
                
                
                    <li><a href="https://dribbble.com/" class="icon style2 fa-dribbble" target="_blank" ><span class="label">Dribbble</span></a></li>
                
                
                    <li><a href="https://github.com/klugjo/hexo-theme-phantom/commits?author=klugjo" class="icon style2 fa-github" target="_blank" ><span class="label">GitHub</span></a></li>
                
                
                    <li><a href="https://plus.google.com/" class="icon style2 fa-google-plus" target="_blank" ><span class="label">Google+</span></a></li>
                
                
                    <li><a href="https://www.behance.net/" class="icon style2 fa-behance" target="_blank" ><span class="label">Behance</span></a></li>
                
                
                    <li><a href="https://500px.com/" class="icon style2 fa-500px" target="_blank" ><span class="label">500px</span></a></li>
                
                
                    <li><a href="wuweijia1994@gmail.com#" class="icon style2 fa-envelope-o" target="_blank" ><span class="label">Email</span></a></li>
                
                
                    <li><a href="\#" class="icon style2 fa-rss" target="_blank" ><span class="label">RSS</span></a></li>
                
            </ul>
        </section>
        <ul class="copyright">
            <li>&copy; Untitled. All rights reserved</li>
            <li>Design: <a href="http://html5up.net" target="_blank">HTML5 UP</a></li>
            <li>Hexo: <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a></li>
        </ul>
    </div>
</footer>
    </div>

    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- skel -->
<script src="/js/skel.min.js"></script>

<!-- Custom Code -->
<script src="/js/util.js"></script>

<!--[if lte IE 8]>
<script src="/js/ie/respond.min.js"></script>
<![endif]-->

<!-- Custom Code -->
<script src="/js/main.js"></script>

<!-- Gallery -->
<script src="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->


</body>

</html>